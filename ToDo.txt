PENDIENTE
----------------------------------------


- En SEPAElementsGenerator, hay que modificar la rutina GenerateDirectDebitTransactionInfo_DrctDbtTxInf para que genere correctamente el BIC (ahora toma erroneamente el CreditorAgentBIC) Ok
- Modificar los deudores de prueba para que usen algun otro banco, aparte de La Caixa, para ver que todo sale correcto. Ok
- Seguramente tendremos que modificar entonces tambien los XML de prueba 'DirectDebitRemmitanceWithVariousPaymentInstructionsAndAmendments.xml' ok













A REVISAR EN EL FICHERO FINAL COMPILADO EN EL ORDENADOR DE ESTEBAN
-------------------------------------------------------------------
- En los tests, para 8000 registros, en el peor momento necesitabamos aprox. 60 Mb. El fichero de salida en UTF-8 es de 6 Mb. ¿Funciona con ordenadores con poca memoria? (Ord. Esteban)?
	-> Probar a eliminar la clase 'BankAccount' y quedarnos con un simple 'string' que contenga el IBAN.
	-> Simplificar la clase DirectdebitMandate para que solo contenga un MandateID, la fecha de creación del mismo, y un 'string' con el IBAN.
	-> En el momento de inicializar la serializacion tenemos DOS copias completas de cada remesa en memoria:
		* Los DirectDebitElements: Un DirectDebitRemittance con su lista de DirectDebitPaymentInstrucions, cada una con su lista de DirectDebitTransations
		* Los objetos ISO20022 serializables: Un CustomerDirectDebitInitiationV02 con su array de PaymentInstructionInformation4 cada uno con un array de DirectDebitTransactionInformation9 
		Podemos probar a:
			* Destruir (set=nothing) el DirectDebitRemittance una vez creado el CustomerDirectdebitInitiationV02.
			* Ir destruyendo los DirectDebitElements a medida que vamos creando su equivalente ISO20022
	-> Si aún así no tira
		-> Crear paso a paso cada elemento DirectDebit, luego convertir a clase ISO20022, serializar a nodo XML, y añadir el nodo al XMLDocument, de esta manera:
			* Primero se crea la estructura basica: un Documento con un CustomerDirectDebitInitiation (y los datos de GroupHeader) los PaymentInstruction necesarios (y los datos de Payment Identification)
			* Luego se van añadiendo uno a uno los DirectDebitTransactions, añadiendo los nodos al documento XML
			* Las sumas de control se pueden poner desde el principio o dejar vacíos. ¡OJO! ¡Esto significa que no deben saltar las excepciones de las sumas de control!
	-> ¿Leer directamente de un DataSet e ir creando directamente las instancias de las clases serializables, pasando por alto todo el trabajo que hemos hecho con DirectDebitElements? Sería una putada...

OPCIONALES PARA TENER EN CUENTA:
----------------------------------------------------------------------------
- Manejo del BIC en el DirectDebit Transaction
	-> Por lo pronto tenemos un apaño con un constructor que lo acepta y un 'setter' para modificarlo despues si es necesario.
	-> Cuando no se especifique: Buscar el BIC usando BankCodes y ponerlo
	-> Cuando se especifique: Comprobarlo a través de BankCodes
	-> Ha de ser OBLIGATORIO:
		-> Modificar los tests que usan un banco ficticio '1234'
	-> ¡OJO! No se puede hacer una lectura del fichero de BankCodes para cada instanciación de DirectDebitTransactions.
		-> BankCodes debe inicializarse APARTE
			-> Como rutina de una clase estática a la que llamar desde DirectDebitTransactions.
			-> Como instancia, y se la pasamos mediante inyector en el constructor. 
- Unificar las excepciones. Todas las excepciones que se lanzan desde un constructor deberian ser TypeinitializationException (y dentro el subtipo - Argumento, ArgumentNull...-)
- Faltan por chequear algunos campos obligatorios en los constructores de DirectDebitTransactions y otros DDElements
- Al deserializar un PaymentStatusReport, hay que revisar los contenidos (que campos existen y sus valores), para diferenciar entre Devolucion y Rechazo

- ¿Hacer que todas las instanciaciones de objetos DirectDebitElements pasen a través de una clase o clases controladoras?
	-> Internamente:
		- SEPAMessagesManager usa:
			* DirectDebitRemittancesManager y PaymentStatusReportManager para acceder a las clases DirectDebitElements
			* SEPAElementsReader y SEPAElementsGenerator para acceder a las clases serializables de ISO20022
		- SEPAElementsGenerator y SEPAElementsReader deben usar DirectdebitRemittancesaManager y PaymentStatusReport? Quizá NO... Podria acceder directamente a las clases DirectDebit Elements
		- DirectDebitRemittancesManager tiene métodos para cerar y gestionar SOLO las clases principales:
			* DirectDebitTransaction
			* DirectDebitPaymentInstruction
			* DirectDebitRemittance
		- PaymentStatusReport tiene métodos para cerar y gestionar SOLO las clases principales:
			* DirectDebitTransactionReject
			* DirectDebitPaymentInstructionReject
			* PaymentStatusReport
	-> Externamente:
		- Con la estructura anterior sigue siendo necesario acceder directamente (sin pasar por 'Manager') a muchos elementos. ¿Cambiarlo?:
			 * 'Billing' (Debtor, SimplifiedBill...)
			 * 'DirectDebitElements' (BankAccount, DirectdebitInitiationContract, DirectdebitMandate)
		













	 
